<div class="container mt-4">
  <h2 class="mb-4"><i class="bi bi-cart3"></i> SEU CARRINHO</h2>
  
  @if (cartService.cartItems().length > 0) {
    <div class="card shadow-sm border-secondary">
      <div class="card-body p-0">
        <table class="table table-hover mb-0 align-middle">
          <thead class="table-light">
            <tr>
              <th class="ps-4">PRODUTO</th>
              <th class="text-center" style="width: 160px;">QTD</th>
              <th class="text-center" style="width: 140px;">PREÇO UNIT.</th>
              <th class="text-center" style="width: 140px;">SUBTOTAL</th>
              <th class="text-center" style="width: 100px;">REMOVER</th>
            </tr>
          </thead>
          <tbody>
            @for (item of cartService.cartItems(); track item.product.id) {
              <tr>
                <td class="ps-4 fw-bold">{{ item.product.nome }}</td>
                
                <td class="text-center">
                  <div class="d-flex justify-content-center">
                    <div class="d-flex align-items-center border border-secondary">
                      <button class="btn btn-sm btn-outline-light border-0 rounded-0 px-2" 
                              (click)="decrease(item)" [disabled]="item.quantity <= 1">
                        <i class="bi bi-dash"></i>
                      </button>

                      <span class="d-flex align-items-center justify-content-center border-start border-end border-secondary text-white fw-bold" 
                            style="min-width: 40px; height: 31px; background-color: #1a1a1a;">
                        {{ item.quantity }}
                      </span>

                      <button class="btn btn-sm btn-outline-light border-0 rounded-0 px-2" 
                              (click)="increase(item)">
                        <i class="bi bi-plus"></i>
                      </button>
                    </div>
                  </div>
                </td>

                <td class="text-center">{{ item.product.preco | currency:'BRL' }}</td>
                <td class="text-center fw-bold text-white">{{ item.subTotal | currency:'BRL' }}</td>
                
                <td class="text-center">
                  <button class="btn btn-outline-danger btn-sm border-0" 
                    (click)="handleRemoveItem(item)" title="Remover item">
                    <i class="bi bi-trash-fill"></i>
                  </button>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
      
      <div class="card-footer bg-transparent border-top border-secondary text-end py-3 pe-4">
        <h4 class="mb-0 fw-bold">TOTAL: <span class="text-white ms-2">{{ cartService.totalValue() | currency:'BRL' }}</span></h4>
      </div>
    </div>
    
    <div class="d-flex justify-content-between mt-4">
      <div class="d-flex gap-2">
        <a routerLink="/products" class="btn btn-outline-light px-4">
          <i class="bi bi-arrow-left me-2"></i> CONTINUAR COMPRANDO
        </a>
        <button class="btn btn-outline-danger px-4" (click)="onClearCart()">
          <i class="bi bi-trash me-2"></i> LIMPAR CARRINHO
        </button>
      </div>

      <button class="btn btn-primary px-5 fw-bold" (click)="finalizeOrder()">
        <i class="bi bi-credit-card me-2"></i> FINALIZAR COMPRA
      </button>
    </div>

  } @else {
    <div class="text-center py-5 border border-secondary mt-4">
      <i class="bi bi-cart-x display-1 text-muted"></i>
      <h3 class="mt-3 text-white">SEU CARRINHO ESTÁ VAZIO.</h3>
      <a routerLink="/products" class="btn btn-primary mt-3 px-4">IR PARA A LOJA</a>
    </div>
  }
</div>